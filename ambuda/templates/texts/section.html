{% extends 'header-main-footer.html' %}
{% import 'macros/dictionaries.html' as m %}

{% macro prev_next_nav(prev, next) %}
{% if prev %}
{% set url = url_for('texts.section', text=text.slug, path=prev.slug) %}
<a class="block p-4" href="{{ url }}">&larr; {{ prev.title }}</a>
{% else %}
<span>&nbsp;</span>
{% endif %}

{% if next %}
{% set url = url_for('texts.section', text=text.slug, path=next.slug) %}
<a class="block p-4" href="{{ url }}">{{ next.title }} &rarr;</a>
{% else %}
<span>&nbsp;</span>
{% endif %}
{% endmacro %}

{% block title %}{{ text.title | devanagari }} {{ section.title }} | Ambuda{% endblock %}

{% block header %}
<header class="bg-zinc-100 flex justify-between">
  <div class="p-4">
<a class="hover:underline" href="{{ url_for('site.index') }}">Ambuda</a> &raquo;
{% set url = url_for('texts.text', slug=text.slug) %}
<a class="hover:underline" href="{{ url }}">
  {{ text.title | devanagari }} 
</a> &raquo;
{{ section.title }}
  </div>

<div class="flex">{{ prev_next_nav(prev, next) }}</div>
</header>
{% endblock %}

{% block main %}
<article class="mx-auto my-24 mx-2 md:mx-8">
  <div class="flex">
    <div class="flex-1 text-xl">{{ content | safe }}</div>
    <div class="hidden md:block flex-1 ml-4 pl-4 border-l">
      <div class="sticky top-4">
        {{ m.dict_form() }}
        {# TODO: 80vh is hacky, find more robust solution. #}
        <div style="overflow: scroll; max-height: 80vh;">
          {{ m.dict_target() }}
        </div>
      </div>
    </div>
  </div>
</article>

<nav class="flex justify-apart bg-zinc-100">
{{ prev_next_nav(prev, next) }}
</nav>

{% endblock %}

{% block footer %}{% endblock %}
